(async()=>{let e=new Map,t=0,r=!1,n=0,a=null,s=null,i=!1,l=0,o=async()=>{try{let e=await (await fetch("https://souzmult.ru/secantion/one/")).text(),r=[],n=e.match(/https:\/\/souzmult\.ru\/secantion\/one\/[^"\s]+\.webp/g);return n&&(r=n.filter(e=>e.includes("Untitled")),(r=Array.from(new Set(r))).sort()),0===r.length&&(r=(await (await fetch("https://api.github.com/repos/Goga0000/secantion/contents/one?ref=main")).json()).map(e=>e.download_url).filter(e=>e)),$=r,t=r.length,console.log(`ðŸ“ ÐÐ²Ñ‚Ð¾Ð¿Ð°Ñ€ÑÐ¸Ð½Ð³: ${t} ÐºÐ°Ð´Ñ€Ð¾Ð² Ñ souzmult.ru`),!0}catch(a){return console.error("âŒ ÐŸÐ°Ñ€ÑÐ¸Ð½Ð³ failed:",a),!1}},$=[],u=async r=>{let n=0;for(let a=0;a<t;a+=r){let s=a%t;if(!e.has(s)){let i=new Image;i.crossOrigin="anonymous",i.src=$[s],await new Promise((t,r)=>{i.onload=()=>{e.set(s,i),n++,t()},i.onerror=()=>t(),i.onabort=()=>t()})}}},c=r=>{if(0===e.size||null===s)return;let n=Math.floor((r+t)%t),i=e.get(n);if(!i)for(let l=1;l<=10;l++){let o=(n-l+t)%t,$=(n+l)%t;if(i=e.get(o)||e.get($))break}if(!i)for(let u of e.values()){i=u;break}if(i){s.save(),s.clearRect(0,0,a.width,a.height);let c=i.naturalWidth/i.naturalHeight,d,h,v=0,_=0;c>1?(d=1024,_=(1024-(h=1024/c))/2):(h=1024,v=(1024-(d=1024*c))/2),s.drawImage(i,v,_,d,h),s.restore()}},d=e=>{if(!(a=e.querySelector("#vid360-canvas")))return;a.width=1024,a.height=1024,s=a.getContext("2d");let t=e=>{i=!0,l=e.clientX||e.touches?.[0]?.clientX||0,a.style.cursor="grabbing",e.preventDefault()},r=e=>{if(!i)return;let t=e.clientX||e.touches?.[0]?.clientX||0;c(n+=(t-l)*.2),l=t,e.preventDefault()},o=()=>{i=!1,a.style.cursor="grab"};a.addEventListener("mousedown",t,{passive:!1}),a.addEventListener("mousemove",r,{passive:!1}),document.addEventListener("mouseup",o),a.addEventListener("touchstart",t,{passive:!1}),a.addEventListener("touchmove",r,{passive:!1}),document.addEventListener("touchend",o),c(0)};setInterval(()=>{let e=document.querySelector(".t-slds__items-wrapper");if(!e)return;let t=e.querySelectorAll(".t-slds__item");if(t.length<2)return;let r=t[t.length-2];if(r.classList.contains("video-replaced"))return;let n=r.querySelector(".t-null__slds-wrapper");n&&(r.classList.add("video-replaced"),n.innerHTML=`
      <div class="video360-container" style="position:relative;width:100%;height:100%;overflow:hidden;">
        <canvas id="vid360-canvas" style="width:100%;height:100%;display:block;cursor:grab;"></canvas>
      </div>
    `,d(n))},500),(async()=>{await o()&&(r=!0,await u(25),setTimeout(()=>u(12),300),setTimeout(()=>u(6),1e3),setTimeout(()=>u(2),2500),setTimeout(()=>u(1),4500))})()})();
