(async()=>{let e=new Map,t=0,a=!1,l=[],i=async()=>{try{return t=(l=(await (await fetch("https://api.github.com/repos/Goga0000/secantion/contents/one?ref=main")).json()).map(e=>e.download_url)).length,console.log(`üìÅ ${t} —Ñ–∞–π–ª–æ–≤ –≤—Å–µ–≥–æ`),!0}catch(e){return console.error("‚ùå API:",e),!1}},s=async a=>{console.log(`üì¶ –ü–ê–ö–ï–¢ —à–∞–≥=${a}...`);let i=0;for(let s=0;s<t;s+=a){let n=s%t;if(!e.has(n))try{let r=await (await fetch(l[n])).blob(),o=new Image;o.src=URL.createObjectURL(r),await new Promise((e,t)=>{o.onload=()=>e(o),o.onerror=t}),e.set(n,o),i++}catch(c){console.warn(`‚ö†Ô∏è –ö–∞–¥—Ä ${n}`)}}console.log(`‚úÖ –ü–ê–ö–ï–¢ ${a}: +${i} –∫–∞–¥—Ä–æ–≤. –ö—ç—à: ${e.size}/${t}`)},n=async()=>{console.log("\uD83D\uDD04 –§–∏–Ω–∞–ª—å–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –û–°–¢–ê–¢–ö–ê...");let a=0;for(let i=0;i<t;i++)if(!e.has(i))try{let s=await (await fetch(l[i])).blob(),n=new Image;n.src=URL.createObjectURL(s),await new Promise((e,t)=>{n.onload=()=>e(n),n.onerror=t}),e.set(i,n),++a%50==0&&console.log(`üîÑ –û—Å—Ç–∞—Ç–æ–∫: +${a}. –í—Å–µ–≥–æ: ${e.size}/${t}`)}catch(r){}console.log(`üéâ ‚úÖ –ü–û–õ–ù–ê–Ø –∑–∞–≥—Ä—É–∑–∫–∞! ${e.size}/${t}`)},r=!1,o=null;(async()=>{await i()&&(console.log("\uD83D\uDE80 –ü—Ä–æ–≥—Ä–µ—Å—Å–∏–≤–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ 25‚Üí12‚Üí6‚Üí2‚Üí–ü–û–õ–ù–ê–Ø..."),await s(25),a=!0,console.log("‚úÖ –ü–ê–ö–ï–¢ 25 –≥–æ—Ç–æ–≤! Video360 –°–¢–ê–†–¢–£–ï–¢!"),setTimeout(()=>s(12),200),setTimeout(()=>s(6),800),setTimeout(()=>s(2),2e3),setTimeout(()=>n(),4e3))})();let c=()=>{let e=document.querySelector(".t-slds__items-wrapper");if(!e)return;let t=e.querySelectorAll(".t-slds__item");if(t.length<2)return;let a=t.length-2,l=t[a];if(l&&!l.classList.contains("video-replaced")){console.log(`üöÄ Video360: –°–†–ê–ó–£ –ø–æ–¥–º–µ–Ω—è–µ–º –ü–†–ï–î–ü–û–°–õ–ï–î–ù–ò–ô —Å–ª–∞–π–¥ #${a}`),l.classList.add("video-replaced");let i=l.querySelector(".t-null__slds-wrapper");i&&(i.innerHTML=`
          <div class="video360-container">
            <vas id="vidd360-canvas"></canvas>
          </div>
        `,$(l),o=l,console.log(`‚úÖ –ü–†–ï–î–ü–û–°–õ–ï–î–ù–ò–ô —Å–ª–∞–π–¥ #${a} –ü–û–î–ú–ï–ù–Å–ù –∏ –ì–û–¢–û–í! (data-slide-index="${l.getAttribute("data-slide-index")}")`))}},d=()=>{c(),o||setTimeout(d,100)};function $(a){let l=a.querySelector("#vid360-canvas"),i=a.querySelector(".video360-container");if(!l||!i)return;let s=l.getContext("2d"),n=0,r=a=>{let l=Math.floor((a+t)%t),i=e.get(l);if(i){s.clearRect(0,0,1024,1024);let n=i.naturalWidth/i.naturalHeight,r,o,c=0,d=0;n>1?(o=1024,c=-((r=1024*n)-1024)/2):(r=1024,d=-((o=1024/n)-1024)/2),s.drawImage(i,c,d,r,o)}else s.clearRect(0,0,1024,1024),s.fillStyle="#f0f0f0",s.fillRect(0,0,1024,1024)};l.width=1024,l.height=1024,s.resetTransform(),r(n);let o=!1,c=0;l.addEventListener("mousedown",e=>{o=!0,c=e.clientX,i.classList.add("dragging"),e.preventDefault(),e.stopPropagation()},{passive:!1}),l.addEventListener("mousemove",e=>{o&&(n+=.05*(e.clientX-c),c=e.clientX,r(n),e.preventDefault(),e.stopPropagation())},{passive:!1}),document.addEventListener("mouseup",()=>{o=!1,i.classList.remove("dragging")}),i.addEventListener("touchstart",e=>{o=!0,c=e.touches[0].clientX,i.classList.add("dragging"),e.preventDefault(),e.stopPropagation()},{passive:!1}),i.addEventListener("touchmove",e=>{o&&e.touches[0]&&(n+=.05*(e.touches[0].clientX-c),c=e.touches[0].clientX,r(n),e.preventDefault(),e.stopPropagation())},{passive:!1}),i.addEventListener("touchend",()=>{o=!1,i.classList.remove("dragging")}),console.log("\uD83C\uDFAE –ü—Ä–µ–¥–ø–æ—Å–ª–µ–¥–Ω–∏–π canvas –ø–æ–ª–Ω–æ—Å—Ç—å—é –≥–æ—Ç–æ–≤!")}d(),setInterval(()=>{if(!a||!o||0===e.size)return;let t=document.querySelector(".t-slds__items-wrapper");if(!t)return;let l=t.querySelectorAll(".t-slds__item");if(l.length<2)return;let i=Array.from(l).findIndex(e=>e===o),s=o.classList.contains("t-slds__item_active");if(console.log(`üéØ –ü–†–ï–î–ü–û–°–õ–ï–î–ù–ò–ô —Å–ª–∞–π–¥ #${i} (data-slide-index="${o.getAttribute("data-slide-index")}") –∞–∫—Ç–∏–≤–µ–Ω: ${s}`),s&&!r){console.log("\uD83D\uDD12 Video360 –ê–ö–¢–ò–í–ï–ù: –ë–õ–û–ö–ò–†–£–ï–ú —Å–≤–∞–π–ø (—Å—Ç—Ä–µ–ª–∫–∏ —Ä–∞–±–æ—Ç–∞—é—Ç)!"),r=!0;let n=t.closest(".t-slds__main");n&&(n.style.touchAction="pan-y pan-x pinch-zoom",n.style.webkitUserDrag="none");let c=o.querySelector(".video360-container");c&&(c.style.touchAction="pan-x")}if(!s&&r){console.log("\uD83D\uDD13 Video360 –ù–ï–∞–∫—Ç–∏–≤–µ–Ω: –í–û–ó–í–†–ê–©–ê–ï–ú —Å–≤–∞–π–ø!"),r=!1;let d=t.closest(".t-slds__main");d&&(d.style.touchAction="",d.style.webkitUserDrag="")}},200)})();
