(async()=>{let e=new Map,t=0,a=!1,i=[],s=async()=>{try{return t=(i=(await (await fetch("https://api.github.com/repos/Goga0000/secantion/contents/one?ref=main")).json()).map(e=>e.download_url)).length,console.log(`üìÅ ${t} —Ñ–∞–π–ª–æ–≤ –≤—Å–µ–≥–æ`),!0}catch(e){return console.error("‚ùå API:",e),!1}},l=async a=>{console.log(`üì¶ –ü–ê–ö–ï–¢ —à–∞–≥=${a}...`);let s=0;for(let l=0;l<t;l+=a){let r=l%t;if(!e.has(r))try{let n=await (await fetch(i[r])).blob(),o=new Image;o.src=URL.createObjectURL(n),await new Promise((e,t)=>{o.onload=()=>e(o),o.onerror=t}),e.set(r,o),s++}catch($){console.warn(`‚ö†Ô∏è –ö–∞–¥—Ä ${r}`)}}console.log(`‚úÖ –ü–ê–ö–ï–¢ ${a}: +${s} –∫–∞–¥—Ä–æ–≤. –ö—ç—à: ${e.size}/${t}`)},r=async()=>{console.log("\uD83D\uDD04 –§–∏–Ω–∞–ª—å–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –û–°–¢–ê–¢–ö–ê...");let a=0;for(let s=0;s<t;s++)if(!e.has(s))try{let l=await (await fetch(i[s])).blob(),r=new Image;r.src=URL.createObjectURL(l),await new Promise((e,t)=>{r.onload=()=>e(r),r.onerror=t}),e.set(s,r),++a%50==0&&console.log(`üîÑ –û—Å—Ç–∞—Ç–æ–∫: +${a}. –í—Å–µ–≥–æ: ${e.size}/${t}`)}catch(n){}console.log(`üéâ ‚úÖ –ü–û–õ–ù–ê–Ø –∑–∞–≥—Ä—É–∑–∫–∞! ${e.size}/${t}`)},n=!1,o=null,$=0;(async()=>{await s()&&(console.log("\uD83D\uDE80 –ü—Ä–æ–≥—Ä–µ—Å—Å–∏–≤–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ 25‚Üí12‚Üí6‚Üí2‚Üí–ü–û–õ–ù–ê–Ø..."),await l(25),a=!0,console.log("‚úÖ –ü–ê–ö–ï–¢ 25 –≥–æ—Ç–æ–≤! Video360 –°–¢–ê–†–¢–£–ï–¢!"),setTimeout(()=>l(12),200),setTimeout(()=>l(6),800),setTimeout(()=>l(2),2e3),setTimeout(()=>r(),4e3))})();let c=()=>{let e=document.querySelector(".t-slds__items-wrapper");if(!e)return!1;let t=e.querySelectorAll(".t-slds__item");if(t.length<2)return!1;let a=t.length-2,i=t[a];if(i&&!i.classList.contains("video-replaced")){console.log(`üöÄ Video360: –°–†–ê–ó–£ –ø–æ–¥–º–µ–Ω—è–µ–º –ü–†–ï–î–ü–û–°–õ–ï–î–ù–ò–ô —Å–ª–∞–π–¥ #${a} (data-slide-index="${i.getAttribute("data-slide-index")}")`),i.classList.add("video-replaced");let s=i.querySelector(".t-null__slds-wrapper");if(s)return s.innerHTML=`
          <div class="video360-container">
            <vas id="vidd360-canvas"></canvas>
          </div>
        `,u(i),o=i,console.log(`‚úÖ –ü–†–ï–î–ü–û–°–õ–ï–î–ù–ò–ô —Å–ª–∞–π–¥ #${a} –ü–û–î–ú–ï–ù–Å–ù –∏ –ì–û–¢–û–í!`),!0}return!1},d=()=>{c()||setTimeout(d,100)};function u(a){let i=a.querySelector("#vid360-canvas"),s=a.querySelector(".video360-container");if(!i||!s)return;let l=i.getContext("2d"),r=a=>{if(!t||0===e.size)return;let i=Math.floor((a+t)%t),s=e.get(i);if(!s)for(let r=1;r<=10&&!(s=e.get((i-r+t)%t)||e.get((i+r)%t));r++);if(s){l.clearRect(0,0,1024,1024);let n=s.naturalWidth/s.naturalHeight,o,$,c=0,d=0;return n>1?($=1024,c=-((o=1024*n)-1024)/2):(o=1024,d=-(($=1024/n)-1024)/2),l.drawImage(s,c,d,o,$),console.log(`üé® –û—Ç—Ä–µ–Ω–¥–µ—Ä–µ–Ω –∫–∞–¥—Ä ${i} (${e.size}/${t} –≤ –∫—ç—à–µ)`),!0}return l.clearRect(0,0,1024,1024),l.fillStyle="#f0f0f0",l.fillRect(0,0,1024,1024),!1};i.width=1024,i.height=1024,l.resetTransform(),console.log("\uD83D\uDCD0 Canvas –Ω–∞—Å—Ç—Ä–æ–µ–Ω: 1024x1024");let n=()=>!!(e.size>0&&r($))&&(console.log("‚úÖ –ü–ï–†–í–´–ô –ö–ê–î–† –û–¢–†–ï–ù–î–ï–†–ï–ù!"),!0);if(!n()){let o=setInterval(()=>{n()&&clearInterval(o)},50)}let c=!1,d=0;i.addEventListener("mousedown",e=>{c=!0,d=e.clientX,s.classList.add("dragging"),e.preventDefault(),e.stopPropagation()},{passive:!1}),i.addEventListener("mousemove",e=>{c&&($+=.05*(e.clientX-d),d=e.clientX,r($),e.preventDefault(),e.stopPropagation())},{passive:!1}),document.addEventListener("mouseup",()=>{c=!1,s.classList.remove("dragging")}),s.addEventListener("touchstart",e=>{e.touches[0]&&(c=!0,d=e.touches[0].clientX,s.classList.add("dragging"),e.preventDefault(),e.stopPropagation())},{passive:!1}),s.addEventListener("touchmove",e=>{if(c&&e.touches[0])$+=.05*(e.touches[0].clientX-d),d=e.touches[0].clientX,r($),e.preventDefault(),e.stopPropagation()},{passive:!1}),s.addEventListener("touchend",()=>{c=!1,s.classList.remove("dragging")},{passive:!1}),console.log("\uD83C\uDFAE –ü—Ä–µ–¥–ø–æ—Å–ª–µ–¥–Ω–∏–π canvas –ø–æ–ª–Ω–æ—Å—Ç—å—é –≥–æ—Ç–æ–≤ —Å —Ä–µ–Ω–¥–µ—Ä–æ–º!")}d(),setInterval(()=>{if(!a||!o||0===e.size)return;let t=document.querySelector(".t-slds__items-wrapper");if(!t)return;let i=o.classList.contains("t-slds__item_active"),s=Array.from(t.querySelectorAll(".t-slds__item")).findIndex(e=>e===o);if(console.log(`üéØ –ü–†–ï–î–ü–û–°–õ–ï–î–ù–ò–ô —Å–ª–∞–π–¥ #${s} –∞–∫—Ç–∏–≤–µ–Ω: ${i}`),i&&!n){console.log("\uD83D\uDD12 Video360 –ê–ö–¢–ò–í–ï–ù: –ë–õ–û–ö–ò–†–£–ï–ú —Å–≤–∞–π–ø (—Å—Ç—Ä–µ–ª–∫–∏ —Ä–∞–±–æ—Ç–∞—é—Ç)!"),n=!0;let l=t.closest(".t-slds__main");l&&(l.style.touchAction="pan-y pan-x pinch-zoom",l.style.webkitUserDrag="none");let r=o.querySelector(".video360-container");r&&(r.style.touchAction="pan-x")}if(!i&&n){console.log("\uD83D\uDD13 Video360 –ù–ï–∞–∫—Ç–∏–≤–µ–Ω: –í–û–ó–í–†–ê–©–ê–ï–ú —Å–≤–∞–π–ø!"),n=!1;let $=t.closest(".t-slds__main");$&&($.style.touchAction="",$.style.webkitUserDrag="")}},200)})();
