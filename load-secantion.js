(async()=>{let e=new Map,t=0,a=!1,l=[],s=async()=>{try{return t=(l=(await (await fetch("https://api.github.com/repos/Goga0000/secantion/contents/one?ref=main")).json()).map(e=>e.download_url)).length,console.log(`üìÅ ${t} —Ñ–∞–π–ª–æ–≤ –≤—Å–µ–≥–æ`),!0}catch(e){return console.error("‚ùå API:",e),!1}},n=async a=>{console.log(`üì¶ –ü–ê–ö–ï–¢ —à–∞–≥=${a}...`);let s=0;for(let n=0;n<t;n+=a){let i=n%t;if(!e.has(i))try{let o=await (await fetch(l[i])).blob(),r=new Image;r.src=URL.createObjectURL(o),await new Promise((e,t)=>{r.onload=()=>e(r),r.onerror=t}),e.set(i,r),s++}catch(c){console.warn(`‚ö†Ô∏è –ö–∞–¥—Ä ${i}`)}}console.log(`‚úÖ –ü–ê–ö–ï–¢ ${a}: +${s} –∫–∞–¥—Ä–æ–≤. –ö—ç—à: ${e.size}/${t}`)},i=async()=>{console.log("\uD83D\uDD04 –§–∏–Ω–∞–ª—å–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –û–°–¢–ê–¢–ö–ê...");let a=0;for(let s=0;s<t;s++)if(!e.has(s))try{let n=await (await fetch(l[s])).blob(),i=new Image;i.src=URL.createObjectURL(n),await new Promise((e,t)=>{i.onload=()=>e(i),i.onerror=t}),e.set(s,i),++a%50==0&&console.log(`üîÑ –û—Å—Ç–∞—Ç–æ–∫: +${a}. –í—Å–µ–≥–æ: ${e.size}/${t}`)}catch(o){}console.log(`üéâ ‚úÖ –ü–û–õ–ù–ê–Ø –∑–∞–≥—Ä—É–∑–∫–∞! ${e.size}/${t}`)},o=!1,r=null;(async()=>{await s()&&(console.log("\uD83D\uDE80 –ü—Ä–æ–≥—Ä–µ—Å—Å–∏–≤–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ 25‚Üí12‚Üí6‚Üí2‚Üí–ü–û–õ–ù–ê–Ø..."),await n(25),a=!0,console.log("‚úÖ –ü–ê–ö–ï–¢ 25 –≥–æ—Ç–æ–≤! Video360 –°–¢–ê–†–¢–£–ï–¢!"),setTimeout(()=>n(12),200),setTimeout(()=>n(6),800),setTimeout(()=>n(2),2e3),setTimeout(()=>i(),4e3))})();let c=()=>{let e=document.querySelector(".t-slds__items-wrapper");if(!e)return;let t=e.querySelectorAll(".t-slds__item");if(t.length<2)return;let a=t.length-1,l=t[a];if(l&&!l.classList.contains("video-replaced")){console.log(`üöÄ Video360: –°–†–ê–ó–£ –ø–æ–¥–º–µ–Ω—è–µ–º –ø–æ—Å–ª–µ–¥–Ω–∏–π —Å–ª–∞–π–¥ #${a}`),l.classList.add("video-replaced");let s=l.querySelector(".t-null__slds-wrapper");s&&(s.innerHTML=`
          <div class="video360-container">
            <vas id="vidd360-canvas"></canvas>
          </div>
        `,d(l),r=l,console.log(`‚úÖ –ü–æ—Å–ª–µ–¥–Ω–∏–π —Å–ª–∞–π–¥ #${a} –ü–û–î–ú–ï–ù–Å–ù –∏ –ì–û–¢–û–í!`))}},$=()=>{c(),r||setTimeout($,100)};function d(a){let l=a.querySelector("#vid360-canvas"),s=a.querySelector(".video360-container");if(!l||!s)return;let n=l.getContext("2d"),i=0,o=a=>{let l=Math.floor((a+t)%t),s=e.get(l);if(s){n.clearRect(0,0,1024,1024);let i=s.naturalWidth/s.naturalHeight,o,r,c=0,$=0;i>1?(r=1024,c=-((o=1024*i)-1024)/2):(o=1024,$=-((r=1024/i)-1024)/2),n.drawImage(s,c,$,o,r)}else n.clearRect(0,0,1024,1024),n.fillStyle="#f0f0f0",n.fillRect(0,0,1024,1024)};l.width=1024,l.height=1024,n.resetTransform(),o(i);let r=!1,c=0;l.addEventListener("mousedown",e=>{r=!0,c=e.clientX,s.classList.add("dragging"),e.preventDefault(),e.stopPropagation()},{passive:!1}),l.addEventListener("mousemove",e=>{r&&(i+=.05*(e.clientX-c),c=e.clientX,o(i),e.preventDefault(),e.stopPropagation())},{passive:!1}),document.addEventListener("mouseup",()=>{r=!1,s.classList.remove("dragging")}),s.addEventListener("touchstart",e=>{r=!0,c=e.touches[0].clientX,s.classList.add("dragging"),e.preventDefault(),e.stopPropagation()},{passive:!1}),s.addEventListener("touchmove",e=>{r&&e.touches[0]&&(i+=.05*(e.touches[0].clientX-c),c=e.touches[0].clientX,o(i),e.preventDefault(),e.stopPropagation())},{passive:!1}),s.addEventListener("touchend",()=>{r=!1,s.classList.remove("dragging")}),console.log("\uD83C\uDFAE –ü–æ—Å–ª–µ–¥–Ω–∏–π canvas –ø–æ–ª–Ω–æ—Å—Ç—å—é –≥–æ—Ç–æ–≤!")}$(),setInterval(()=>{if(!a||!r||0===e.size)return;let t=document.querySelector(".t-slds__items-wrapper");if(!t)return;let l=t.querySelectorAll(".t-slds__item");if(l.length<2)return;let s=r.classList.contains("t-slds__item_active"),n=Array.from(l).findIndex(e=>e===r);if(console.log(`üéØ –í–∏–¥–µ–æ —Å–ª–∞–π–¥ #${n} –∞–∫—Ç–∏–≤–µ–Ω: ${s}`),s&&!o){console.log("\uD83D\uDD12 Video360 –ê–ö–¢–ò–í–ï–ù: –ë–õ–û–ö–ò–†–£–ï–ú —Å–≤–∞–π–ø (—Å—Ç—Ä–µ–ª–∫–∏ —Ä–∞–±–æ—Ç–∞—é—Ç)!"),o=!0;let i=t.closest(".t-slds__main");i&&(i.style.touchAction="pan-y pan-x pinch-zoom",i.style.webkitUserDrag="none");let c=r.querySelector(".video360-container");c&&(c.style.touchAction="pan-x")}if(!s&&o){console.log("\uD83D\uDD13 Video360 –ù–ï–∞–∫—Ç–∏–≤–µ–Ω: –í–û–ó–í–†–ê–©–ê–ï–ú —Å–≤–∞–π–ø!"),o=!1;let $=t.closest(".t-slds__main");$&&($.style.touchAction="",$.style.webkitUserDrag="")}},200)})();
