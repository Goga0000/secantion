(async()=>{let e=new Map,t=0,s=!1,l=[],a=0,r=async()=>{try{return t=(l=(await (await fetch("https://api.github.com/repos/Goga0000/secantion/contents/one?ref=main")).json()).map(e=>e.download_url)).length,console.log(`üìÅ ${t} —Ñ–∞–π–ª–æ–≤ –≤—Å–µ–≥–æ`),!0}catch(e){return console.error("‚ùå API:",e),!1}},o=async s=>{console.log(`üì¶ –ü–ê–ö–ï–¢ —à–∞–≥=${s}...`);let a=0;for(let r=0;r<t;r+=s){let o=r%t;if(!e.has(o))try{let i=await (await fetch(l[o])).blob(),n=new Image;n.src=URL.createObjectURL(i),await new Promise((e,t)=>{n.onload=()=>e(n),n.onerror=t}),e.set(o,n),a++}catch(c){console.warn(`‚ö†Ô∏è –ö–∞–¥—Ä ${o}`)}}console.log(`‚úÖ –ü–ê–ö–ï–¢ ${s}: +${a} –∫–∞–¥—Ä–æ–≤. –ö—ç—à: ${e.size}/${t}`)},i=async()=>{console.log("\uD83D\uDD04 –§–∏–Ω–∞–ª—å–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –û–°–¢–ê–¢–ö–ê...");let s=0;for(let a=0;a<t;a++)if(!e.has(a))try{let r=await (await fetch(l[a])).blob(),o=new Image;o.src=URL.createObjectURL(r),await new Promise((e,t)=>{o.onload=()=>e(o),o.onerror=t}),e.set(a,o),++s%50==0&&console.log(`üîÑ –û—Å—Ç–∞—Ç–æ–∫: +${s}. –í—Å–µ–≥–æ: ${e.size}/${t}`)}catch(i){}console.log(`üéâ ‚úÖ –ü–û–õ–ù–ê–Ø –∑–∞–≥—Ä—É–∑–∫–∞! ${e.size}/${t}`)};(async()=>{await r()&&(console.log("\uD83D\uDE80 –ü—Ä–æ–≥—Ä–µ—Å—Å–∏–≤–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ 25‚Üí12‚Üí6‚Üí2‚Üí–ü–û–õ–ù–ê–Ø..."),await o(25),s=!0,console.log("‚úÖ –ü–ê–ö–ï–¢ 25 –≥–æ—Ç–æ–≤! Video360 –°–¢–ê–†–¢–£–ï–¢!"),setTimeout(()=>o(12),200),setTimeout(()=>o(6),800),setTimeout(()=>o(2),2e3),setTimeout(()=>i(),4e3))})();let n=new MutationObserver(e=>{e.forEach(e=>{if("attributes"===e.type&&"class"===e.attributeName){let t=e.target;if(t.classList.contains("video-replaced")&&t.classList.contains("t-slds__item_active")){console.log("\uD83C\uDFAF Video360 –ê–ö–¢–ò–í–ï–ù! –î–æ–±–∞–≤–ª—è–µ–º block –∫ .t-slds__container");let s=t.closest(".t-slds__items-wrapper")?.closest(".t-slds")?.querySelector(".t-slds__container")||t.closest(".t-slds__wrapper")?.querySelector(".t-slds__container")||t.closest(".t-slds__container");s&&(s.classList.add("block"),console.log("‚úÖ –ö–ª–∞—Å—Å block –î–û–ë–ê–í–õ–ï–ù –∫ .t-slds__container"))}else if(t.classList.contains("video-replaced")&&!t.classList.contains("t-slds__item_active")){console.log("\uD83D\uDD04 Video360 –ù–ï–ê–ö–¢–ò–í–ï–ù! –ü—Ä–æ–≤–µ—Ä—è–µ–º .t-slds__container...");let l=document.querySelector(".video-replaced.t-slds__item_active"),a=t.closest(".t-slds__items-wrapper")?.closest(".t-slds")?.querySelector(".t-slds__container")||t.closest(".t-slds__wrapper")?.querySelector(".t-slds__container")||t.closest(".t-slds__container");a&&!l&&(a.classList.remove("block"),console.log("‚úÖ –ö–ª–∞—Å—Å block –£–î–ê–õ–ï–ù —Å .t-slds__container"))}}})}),c=()=>{document.querySelectorAll(".video-replaced").forEach(e=>{n.observe(e,{attributes:!0,attributeFilter:["class"]})})},d=null,$=!1;setInterval(()=>{if(!s||0===e.size)return;let l=document.querySelector(".t-slds__items-wrapper");l&&!d&&(d=l.closest(".t-slds__main"))&&console.log("\uD83C\uDFAF .t-slds__main –¥–ª—è –¥—Ä–∞–≥–∞ –Ω–∞–π–¥–µ–Ω:",d);let r=document.querySelector(".t-slds__items-wrapper");if(!r)return;let o=r.querySelectorAll(".t-slds__item");if(o.length<2)return;let i=o[o.length-2];if(i?.classList.contains("video-replaced"))return;let n=i.querySelector(".t-null__slds-wrapper");if(!n)return;console.log("‚ö° Video360: –∑–∞–º–µ–Ω–∞!"),i.classList.add("video-replaced"),n.innerHTML=`
      <div class="video360-container">
        <canvas id="vid360-canvas"></canvas>
      </div>
    `,c();let u=document.getElementById("vid360-canvas"),v=u.getContext("2d"),g=n.querySelector(".video360-container"),p=s=>{let l=Math.floor((s+t)%t),a=e.get(l);if(a){f(a);return}for(let r=1;r<=10;r++){let o=(l-r+t)%t,i=(l+r)%t;if(a=e.get(o)||e.get(i)){f(a);return}}for(let n of e.values()){f(n);return}v.clearRect(0,0,1024,1024),v.fillStyle="#f0f0f0",v.fillRect(0,0,1024,1024)},f=e=>{v.clearRect(0,0,1024,1024);let t=e.naturalWidth/e.naturalHeight,s,l,a=0,r=0;t>1?(l=1024,a=-((s=1024*t)-1024)/2):(s=1024,r=-((l=1024/t)-1024)/2),v.drawImage(e,a,r,s,l)};u.width=1024,u.height=1024,v.resetTransform(),p(a);let w=!1,_=0,m=e=>{w=!0,_=e,g.classList.add("dragging"),$=!0,console.log("\uD83D\uDC46 –î—Ä–∞–≥ –í–ò–î–ï–û –Ω–∞—á–∞–ª!")},h=e=>{w&&(a+=.05*(e-_),_=e,p(a))},y=()=>{w=!1,g.classList.remove("dragging"),$=!1,console.log("‚úã –î—Ä–∞–≥ –í–ò–î–ï–û –∑–∞–∫–æ–Ω—á–∏–ª—Å—è")};u.addEventListener("mousedown",e=>{m(e.clientX),e.preventDefault()}),u.addEventListener("touchstart",e=>{m(e.touches[0].clientX),e.preventDefault()},{passive:!1});let L=e=>{if(!$)return;let t=e.clientX||e.touches&&e.touches[0]?.clientX;void 0!==t&&(h(t),e.preventDefault(),e.stopPropagation())},b=()=>{$&&y()};d&&!d.dataset.video360Handlers&&(d.dataset.video360Handlers="true",d.addEventListener("mousemove",L,{passive:!1}),d.addEventListener("touchmove",L,{passive:!1}),document.addEventListener("mouseup",b),document.addEventListener("touchend",b),console.log("\uD83C\uDF10 ‚úÖ –ì–ª–æ–±–∞–ª—å–Ω—ã–π –¥—Ä–∞–≥ –Ω–∞ .t-slds__main –ê–ö–¢–ò–í–ï–ù!")),console.log("\uD83D\uDE80 ‚úÖ Video360 –≥–æ—Ç–æ–≤! block –Ω–∞ .t-slds__container + –¥—Ä–∞–≥ –Ω–∞ .t-slds__main")},500)})();
