(async()=>{let e=new Map,t=0,a=!1,l=[],n=0,r=async()=>{try{let e=await fetch("https://api.github.com/repos/Goga0000/secantion/contents/one?ref=main"),a=await e.json();return t=(l=a.map(e=>e.download_url)).length,console.log(`üìÅ ${t} —Ñ–∞–π–ª–æ–≤ –≤—Å–µ–≥–æ`),!0}catch(n){return console.error("‚ùå API:",n),!1}},i=async()=>{await r()&&(console.log("\uD83D\uDE80 –ü—Ä–æ–≥—Ä–µ—Å—Å–∏–≤–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ 25‚Üí12‚Üí6‚Üí2‚Üí–ü–û–õ–ù–ê–Ø..."),await s(25),a=!0,console.log("‚úÖ –ü–ê–ö–ï–¢ 25 –≥–æ—Ç–æ–≤! Video360 –°–¢–ê–†–¢–£–ï–¢!"),setTimeout(()=>s(12),200),setTimeout(()=>s(6),800),setTimeout(()=>s(2),2e3),setTimeout(()=>{console.log("\uD83D\uDE80 –ü–û–õ–ù–ê–Ø –∑–∞–≥—Ä—É–∑–∫–∞ –í–°–ï–• –∫–∞–¥—Ä–æ–≤..."),$()},4e3))},s=async a=>{console.log(`üì¶ –ü–ê–ö–ï–¢ —à–∞–≥=${a}...`);let n=0;for(let r=0;r<t;r+=a){let i=r%t;if(!e.has(i))try{let s=await fetch(l[i]),$=await s.blob(),o=new Image;o.src=URL.createObjectURL($),await new Promise((e,t)=>{o.onload=()=>e(o),o.onerror=t}),e.set(i,o),n++}catch(c){console.warn(`‚ö†Ô∏è –ö–∞–¥—Ä ${i}`)}}console.log(`‚úÖ –ü–ê–ö–ï–¢ ${a}: +${n} –∫–∞–¥—Ä–æ–≤. –ö—ç—à: ${e.size}/${t}`)},$=async()=>{console.log("\uD83D\uDD04 –§–∏–Ω–∞–ª—å–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –û–°–¢–ê–¢–ö–ê...");let a=0;for(let n=0;n<t;n++)if(!e.has(n))try{let r=await fetch(l[n]),i=await r.blob(),s=new Image;s.src=URL.createObjectURL(i),await new Promise((e,t)=>{s.onload=()=>e(s),s.onerror=t}),e.set(n,s),++a%50==0&&console.log(`üîÑ –û—Å—Ç–∞—Ç–æ–∫: +${a}. –í—Å–µ–≥–æ: ${e.size}/${t}`)}catch($){console.warn(`‚ö†Ô∏è –§–∏–Ω–∞–ª ${n}`)}console.log(`üéâ ‚úÖ –ü–û–õ–ù–ê–Ø –∑–∞–≥—Ä—É–∑–∫–∞! ${e.size}/${t} –í–°–ï –∫–∞–¥—Ä—ã –≥–æ—Ç–æ–≤—ã!`)};i(),setInterval(()=>{if(!a||0===e.size)return;let l=document.querySelector(".t-slds__items-wrapper");if(!l)return;let r=l.querySelectorAll(".t-slds__item");if(r.length<2)return;let i=r[r.length-2];if(i?.classList.contains("video-replaced"))return;let s=i.querySelector(".t-null__slds-wrapper");if(!s)return;console.log("‚ö° Video360: –∑–∞–º–µ–Ω–∞!"),i.classList.add("video-replaced"),s.innerHTML=`
      <div class="video360-container">
        <canvas id="vid360-canvas"></canvas>
      </div>
    `;let $=document.getElementById("vid360-canvas"),o=$.getContext("2d"),c=s.querySelector(".video360-container"),d=()=>{$.width=1024,$.height=1024,o.resetTransform()},g=a=>{let l=Math.floor((a+t)%t),n=e.get(l);if(!n){o.clearRect(0,0,1024,1024),o.fillStyle="#f0f0f0",o.fillRect(0,0,1024,1024),o.fillStyle="#666",o.font="bold 64px Arial",o.textAlign="center",o.textBaseline="middle",o.fillText(`${Math.round(e.size/t*100)}%`,512,512);return}o.clearRect(0,0,1024,1024);let r=n.naturalWidth/n.naturalHeight,i,s,$=0,c=0;r>1?(s=1024,$=-((i=1024*r)-1024)/2):(i=1024,c=-((s=1024/r)-1024)/2),o.drawImage(n,$,c,i,s)};d(),g(n);let u=!1,_=0;$.addEventListener("mousedown",e=>{u=!0,_=e.clientX,c.classList.add("dragging"),e.preventDefault()}),document.addEventListener("mousemove",e=>{if(u){let t=e.clientX-_;n+=.05*t,_=e.clientX,g(n)}}),document.addEventListener("mouseup",()=>{u=!1,c.classList.remove("dragging")}),$.addEventListener("touchstart",e=>{u=!0,_=e.touches[0].clientX,c.classList.add("dragging"),e.preventDefault()},{passive:!1}),document.addEventListener("touchmove",e=>{if(u&&e.touches[0]){let t=e.touches[0].clientX-_;n+=.05*t,_=e.touches[0].clientX,g(n),e.preventDefault()}},{passive:!1}),document.addEventListener("touchend",()=>{u=!1,c.classList.remove("dragging")}),console.log("\uD83D\uDE80 ‚úÖ 25‚Üí12‚Üí6‚Üí2‚Üí–ü–û–õ–ù–ê–Ø!")},500)})();
