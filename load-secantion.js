(async()=>{let e=new Map,t=0,a=!1,s=[],i=0,l=async()=>{try{return t=(s=(await (await fetch("https://api.github.com/repos/Goga0000/secantion/contents/one?ref=main")).json()).map(e=>e.download_url)).length,console.log(`üìÅ ${t} —Ñ–∞–π–ª–æ–≤ –≤—Å–µ–≥–æ`),!0}catch(e){return console.error("‚ùå API:",e),!1}},n=async a=>{console.log(`üì¶ –ü–ê–ö–ï–¢ —à–∞–≥=${a}...`);let i=0;for(let l=0;l<t;l+=a){let n=l%t;if(!e.has(n))try{let o=await (await fetch(s[n])).blob(),r=new Image;r.src=URL.createObjectURL(o),await new Promise((e,t)=>{r.onload=()=>e(r),r.onerror=t}),e.set(n,r),i++}catch(c){console.warn(`‚ö†Ô∏è –ö–∞–¥—Ä ${n}`)}}console.log(`‚úÖ –ü–ê–ö–ï–¢ ${a}: +${i} –∫–∞–¥—Ä–æ–≤. –ö—ç—à: ${e.size}/${t}`)},o=async()=>{console.log("\uD83D\uDD04 –§–∏–Ω–∞–ª—å–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –û–°–¢–ê–¢–ö–ê...");let a=0;for(let i=0;i<t;i++)if(!e.has(i))try{let l=await (await fetch(s[i])).blob(),n=new Image;n.src=URL.createObjectURL(l),await new Promise((e,t)=>{n.onload=()=>e(n),n.onerror=t}),e.set(i,n),++a%50==0&&console.log(`üîÑ –û—Å—Ç–∞—Ç–æ–∫: +${a}. –í—Å–µ–≥–æ: ${e.size}/${t}`)}catch(o){}console.log(`üéâ ‚úÖ –ü–û–õ–ù–ê–Ø –∑–∞–≥—Ä—É–∑–∫–∞! ${e.size}/${t}`)},r=!1,c=null;(async()=>{await l()&&(console.log("\uD83D\uDE80 –ü—Ä–æ–≥—Ä–µ—Å—Å–∏–≤–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ 25‚Üí12‚Üí6‚Üí2‚Üí–ü–û–õ–ù–ê–Ø..."),await n(25),a=!0,console.log("‚úÖ –ü–ê–ö–ï–¢ 25 –≥–æ—Ç–æ–≤! Video360 –°–¢–ê–†–¢–£–ï–¢!"),setTimeout(()=>n(12),200),setTimeout(()=>n(6),800),setTimeout(()=>n(2),2e3),setTimeout(()=>o(),4e3))})(),setInterval(()=>{if(!a||0===e.size)return;let s=document.querySelector(".t-slds__items-wrapper");if(!s)return;let l=s.querySelectorAll(".t-slds__item");if(l.length<2)return;let n=Array.from(l).find(e=>e.classList.contains("video-replaced")&&e.classList.contains("t-slds__item_active"));if(n&&!c){console.log("\uD83D\uDD12 Video360 ACTIVE: –±–ª–æ–∫–∏—Ä—É–µ–º –°–í–ê–ô–ü (—Å—Ç—Ä–µ–ª–∫–∏ —Ä–∞–±–æ—Ç–∞—é—Ç)!"),c=n;let o=s.closest(".t-slds__main");o&&(o.style.touchAction="pan-y",o.style.webkitUserDrag="none",r=!0);let $=n.querySelector(".video360-container");$&&($.style.touchAction="pan-x",$.style.pointerEvents="auto")}if(n&&c!==n&&(c=n,console.log("\uD83D\uDD04 Video360: –Ω–æ–≤—ã–π –∞–∫—Ç–∏–≤–Ω—ã–π —Å–ª–∞–π–¥")),n){let d=n.querySelector(".t-null__slds-wrapper");if(!d)return;n.classList.contains("video-replaced")||(console.log("‚ö° Video360: –∑–∞–º–µ–Ω–∞ –∞–∫—Ç–∏–≤–Ω–æ–≥–æ —Å–ª–∞–π–¥–∞!"),n.classList.add("video-replaced"),d.innerHTML=`
          <div class="video360-container">
            <vas id="vidd360-canvas"></canvas>
          </div>
        `);let u=document.getElementById("vid360-canvas"),g=u.getContext("2d"),v=n.querySelector(".video360-container"),p=a=>{let s=Math.floor((a+t)%t),i=e.get(s);if(i){f(i);return}for(let l=1;l<=10;l++){let n=(s-l+t)%t,o=(s+l)%t;if(i=e.get(n)||e.get(o)){f(i);return}}for(let r of e.values()){f(r);return}g.clearRect(0,0,1024,1024),g.fillStyle="#f0f0f0",g.fillRect(0,0,1024,1024)},f=e=>{g.clearRect(0,0,1024,1024);let t=e.naturalWidth/e.naturalHeight,a,s,i=0,l=0;t>1?(s=1024,i=-((a=1024*t)-1024)/2):(a=1024,l=-((s=1024/t)-1024)/2),g.drawImage(e,i,l,a,s)};u.width=1024,u.height=1024,g.resetTransform(),p(i);let _=!1,h=0;u.addEventListener("mousedown",e=>{_=!0,h=e.clientX,v.classList.add("dragging"),e.preventDefault(),e.stopPropagation()},{passive:!1}),u.addEventListener("mousemove",e=>{_&&(i+=.05*(e.clientX-h),h=e.clientX,p(i),e.preventDefault(),e.stopPropagation())},{passive:!1}),document.addEventListener("mouseup",()=>{_=!1,v.classList.remove("dragging")}),v.addEventListener("touchstart",e=>{_=!0,h=e.touches[0].clientX,v.classList.add("dragging"),e.preventDefault(),e.stopPropagation()},{passive:!1}),v.addEventListener("touchmove",e=>{_&&e.touches[0]&&(i+=.05*(e.touches[0].clientX-h),h=e.touches[0].clientX,p(i),e.preventDefault(),e.stopPropagation())},{passive:!1}),v.addEventListener("touchend",()=>{_=!1,v.classList.remove("dragging")}),console.log("\uD83C\uDFAE Video360 –∞–∫—Ç–∏–≤–µ–Ω: –°–í–ê–ô–ü ‚ùå | Canvas 360\xb0 ‚úÖ | –°—Ç—Ä–µ–ª–∫–∏ ‚úÖ")}if(c&&!c.classList.contains("t-slds__item_active")){console.log("\uD83D\uDD13 Video360 INACTIVE: –≤–æ–∑–≤—Ä–∞—â–∞–µ–º —Å–≤–∞–π–ø!");let w=c.closest(".t-slds__main");w&&(w.style.touchAction="",w.style.webkitUserDrag="",r=!1),c=null}},500)})();
