(async()=>{let e=new Map,t=0,l=!1,s=[],n=0,r=null,a=!1,i=0,o=null,d=null,u=!1,c=null,$=null,v=null,p=!1,_=null,f=null,m=async()=>{try{return t=(s=(await (await fetch("https://api.github.com/repos/Goga0000/secantion/contents/six?ref=main")).json()).map(e=>e.download_url)).length,!0}catch(e){return!1}},w=async l=>{let n=0;for(let r=0;r<t;r+=l){let a=r%t;if(!e.has(a))try{let i=await (await fetch(s[a])).blob(),o=new Image;o.src=URL.createObjectURL(i),await new Promise((e,t)=>{o.onload=()=>e(),o.onerror=t}),e.set(a,o),n++}catch(d){}}},h=async()=>{let l=0;for(let n=0;n<t;n++)if(!e.has(n))try{let r=await (await fetch(s[n])).blob(),a=new Image;a.src=URL.createObjectURL(r),await new Promise((e,t)=>{a.onload=()=>e(),a.onerror=t}),e.set(n,a),l++}catch(i){}};(async()=>{await m()&&(await w(25),l=!0,setTimeout(()=>w(12),200),setTimeout(()=>w(6),800),setTimeout(()=>w(2),2e3),setTimeout(()=>h(),4e3))})();let y=()=>{_&&f&&(_.width=1024,_.height=1024,f.resetTransform&&f.resetTransform())},g=e=>{if(!f)return;f.clearRect(0,0,1024,1024);let t=e.naturalWidth/e.naturalHeight,l,s,n=0,r=0;t>1?(s=1024,n=-(((l=1024*t)-1024)/2)):(l=1024,r=-(((s=1024/t)-1024)/2)),f.drawImage(e,n,r,l,s)},b=l=>{if(!f||0===t)return;let s=Math.floor((l+t)%t),n=e.get(s);if(n){g(n);return}for(let r=1;r<=10;r++){let a=(s-r+t)%t,i=(s+r)%t;if(n=e.get(a)||e.get(i)){g(n);return}}for(let o of e.values()){g(o);return}f.clearRect(0,0,1024,1024),f.fillStyle="#f0f0f0",f.fillRect(0,0,1024,1024)},L=()=>{u=!0,null!==o&&(cancelAnimationFrame(o),o=null),null!==d&&(clearTimeout(d),d=null),null!==c&&(clearInterval(c),c=null)},S=()=>{if(p||u||null!==o||!t||!f)return;let e=.2*t,l=n,s=l+e,r="forward",a=null,i=t=>{if(u){o=null;return}a||(a=t);let d=Math.min((t-a)/1500,1);"forward"===r?(b(n=l+e*d),d<1||(r="backward",a=null),o=requestAnimationFrame(i)):(b(n=s-e*d),d<1?o=requestAnimationFrame(i):(n=l,b(n),o=null,p=!0))};o=requestAnimationFrame(i)};setInterval(()=>{if(!l||0===e.size)return;let t=document.querySelector(".t-slds__items-wrapper");t&&!r&&(r=t.closest(".t-slds"));let s=document.querySelector(".t-slds__items-wrapper");if(!s)return;let o=s.querySelectorAll(".t-slds__item");if(o.length<2)return;let d=o[o.length-2];if(d?.classList.contains("video-replaced"))return;let u=d.querySelector(".t-null__slds-wrapper");if(!u)return;d.classList.add("video-replaced"),u.innerHTML=`
<div class="video360-container">
<canvas id="vid360-canvas"></canvas>
<div class="video360-controls">
<button class="video360-btn video360-prev" type="button" tabindex="0" style="background-image: url('https://static.tildacdn.com/tild3961-3766-4131-a531-386233346139/left.svg')"></button>
<button class="video360-btn video360-next" type="button" tabindex="0" style="background-image: url('https://static.tildacdn.com/tild3930-3062-4362-b730-663038363061/right.svg')"></button>
</div>
</div>
`,f=(_=document.getElementById("vid360-canvas")).getContext("2d"),y(),b(n);let $=u.querySelector(".video360-prev"),v=u.querySelector(".video360-next");if(r&&!r.video360DragSetup){r.video360DragSetup=!0;let p=e=>void 0!==e.clientX?e.clientX:e.touches?.[0]?.clientX||0,m=e=>{a=!0,i=p(e),L()},w=e=>{if(!a)return;let t=p(e);n+=.1*(t-i),i=t,b(n),e.preventDefault()},h=()=>{a&&(a=!1)};r.addEventListener("mousedown",m,{passive:!1}),r.addEventListener("mousemove",w,{passive:!1}),document.addEventListener("mouseup",h),r.addEventListener("touchstart",m,{passive:!1}),r.addEventListener("touchmove",w,{passive:!1}),document.addEventListener("touchend",h)}let g=e=>{L();let t="next"===e?1:-1;null!==c&&clearInterval(c),c=setInterval(()=>{b(n+=t)},16)},S=()=>{null!==c&&(clearInterval(c),c=null)};if($&&v){let q=(e,t)=>{let l=e=>{e.preventDefault(),e.stopPropagation(),g(t)},s=e=>{e.preventDefault(),e.stopPropagation()},n=e=>{S(),e.stopPropagation()};e.addEventListener("mousedown",l),e.addEventListener("touchstart",l,{passive:!1}),e.addEventListener("click",s),document.addEventListener("mouseup",n),document.addEventListener("touchend",n),document.addEventListener("touchcancel",n)};q($,"prev"),q(v,"next")}},500),v=setInterval(()=>{if(!l||0===e.size)return;let t=document.querySelector(".t-slds__items-wrapper");if(!t)return;let s=t.querySelector(".t-slds__item.t-slds__item_active"),n=t.querySelector(".t-slds__item.video-replaced");if(n){if(s===n&&$!==n){$=n;let r=n.closest(".t-slds__items-wrapper")?.closest(".t-slds")?.querySelector(".t-slds__main")||n.closest(".t-slds__wrapper")?.querySelector(".t-slds__main")||n.closest(".t-slds__main");r&&r.classList.add("block"),null!==d&&(clearTimeout(d),d=null),null!==o&&(cancelAnimationFrame(o),o=null),u=!1,d=setTimeout(()=>{u||S(),d=null},2e3)}if($&&s!==$){let a=$.closest(".t-slds__items-wrapper")?.closest(".t-slds")?.querySelector(".t-slds__main")||$.closest(".t-slds__wrapper")?.querySelector(".t-slds__main")||$.closest(".t-slds__main");a&&a.classList.remove("block"),null!==d&&(clearTimeout(d),d=null),null!==o&&(cancelAnimationFrame(o),o=null),$=null}}},300)})();
